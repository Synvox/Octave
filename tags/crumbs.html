<crumbs>

  <ul if={ data }>
    <li onclick={ reset }>Library</li>

    <li class="chevron" if={ data.artist }>›</li>
    <li if={ data.artist } onclick={ search } name="artist">{data.artist}</li>

    <li class="chevron" if={ data.album }>›</li>
    <li if={ data.album } onclick={ search } name="album">{data.album}</li>

    <li class="chevron" if={ data.name }>›</li>
    <li onclick={ search } name="name">{data.name}</li>
  </ul>

  <style type="less">
    body {
      background: #202020;
    }
    crumbs {
      background: #202020;
      ul {
        height: 40px;
        font-size: 16px;
        color: #ddd;
        line-height: 30px;
        position: absolute;
        bottom: 0px;
        left: 20px;
        -webkit-user-select: none;
        white-space: nowrap;
        li {
          display: inline-block;
          cursor: pointer;
          &.chevron {
            font-size: 2.5em;
            position: relative;
            top: 6px;
            opacity: .5;
          }
          &:hover {
            color: #fff
          }
        }
      }
    }
  </style>
  <script>

    var self = this
    self.data = null;

    App.on('selected_track',function(data){
      self.update({data: data});
    })

    self.search = function(e){
      var query = $(e.target).text()
      var field = $(e.target).attr('name')
      App.trigger('filter_tracks_by',field+':'+query)
    }

    self.reset = function(e){
      App.trigger('filter_tracks_by','')
    }

    var changes = db.changes({
      since: 'now',
      live: true,
      include_docs: true
    }).on('change', function(change) {
      var doc = change.doc;
      if (doc._id === self.data._id) {
        self.data = doc;
        self.update();
      }
    });

  </script>

</crumbs>
