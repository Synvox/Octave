<toolbar>
  <div class="inner">
    <div class="left">
      <svg viewBox="0 0 24 24" onclick={ playPrev }>
        <path d="M11.5,12L20,18V6M11,18V6L2.5,12L11,18Z" />
      </svg>
      <svg viewBox="0 0 24 24" onclick={ playPause }>
        <path if={ playing } d="M14,19.14H18V5.14H14M6,19.14H10V5.14H6V19.14Z" />
        <path if={ !playing }  d="M8,5.14V19.14L19,12.14L8,5.14Z" />
      </svg>
      <svg viewBox="0 0 24 24" onclick={ playNext }>
        <path d="M13,6V18L21.5,12M4,18L12.5,12L4,6V18Z" />
      </svg>
    </div>
    <div class="center" id="waveform">
    </div>
    <div class="right">
      <form onsubmit={ search }>
        <input type="submit" hidden>
        <input onkeyup={ search } class="query">
      </form>
    </div>
  </div>
  <crumbs></crumbs>
  <style type="less">
    toolbar {
      display: block;
      height: 110px;
      position: fixed;
      left: 0px;
      right: 0px;
      top: 0px;
      background: white;
      box-shadow: 0px 0px 2px rgba(0,0,0,.3),
                  0px 0px 16px rgba(0,0,0,.1);
      overflow: hidden;
      .inner {
        position: absolute;
        top: 60px;
        height: 50px;
        left: 0px;
        right: 0px;
        overflow: hidden;
        z-index: 10;
      }
      crumbs {
        position: absolute;
        left: 0;
        right: 0;
        height: 60px;
        top: 0px;
        z-index: 9;
      }
      .left {
        padding: 4px 0px;
        width: 25vw;
        text-align: center;
        position: absolute;
        top: 0px;
        left: 0px;
        bottom: 0px;
        z-index: 10;
        -webkit-user-select: none;
        box-shadow: 0px 0px 2px rgba(0,0,0,.3),
                    0px 0px 16px rgba(0,0,0,.1);
        svg {
          width: 40px;
          path {
            fill: #555;
          }
          &:active path {
            fill: #000;
          }
        }
      }
      .center {
        text-align: center;
        position: absolute;
        top: 0px;
        right: 25vw;
        left: 25vw;
        bottom: 0px;
        z-index: 9;
        border-left: 1px solid #ccc;
        border-right: 1px solid #ccc;
        background: rgba(0,0,0,.03);
        canvas {
          width: 100%;
        }
      }
      .right {
        width: 25vw;
        text-align: center;
        position: absolute;
        top: 0px;
        right: 0px;
        bottom: 0px;
        z-index: 10;
        box-shadow: 0px 0px 2px rgba(0,0,0,.3),
                    0px 0px 16px rgba(0,0,0,.1);
        input {
          border: 1px solid #ccc;
          border-radius: 3px;
          position: absolute;
          top: 10px;
          right: 10px;
          height: 30px;
          width: calc(100% - 10px);
          padding: 0px 8px;
          &:focus {
            outline: none;
          }
        }
      }
    }
  </style>
  <script>
    var self = this;
    self.playing = false;

    self.playPause = function(){
      App.trigger('play_pause')
    }
    self.playNext = function(){
      App.trigger('play_next')
    }
    self.playPrev = function(){
      App.trigger('play_prev')
    }
    App.on('track_playing',function(){
      self.update({playing: true})
    })
    App.on('track_pausing',function(){
      self.update({playing: false})
    })

    var timeout = null;
    self.search =  function(){
      var query = $(self.root).find('input.query').val()

      if (timeout)
        window.clearTimeout(timeout)

      timeout = window.setTimeout(function(){
        App.trigger('filter_tracks_by',query.toLowerCase().split(' '))
      },300)
    }
  </script>
</toolbar>
